import{r as c,cn as g,co as q,cp as v,k as E}from"./index-FtmuCnrX.js";var S=()=>{const[n,a]=c.useState(""),[s,t]=c.useState(""),r=c.useCallback(g(i=>t(i),300),[]);return c.useEffect(()=>(r(n),()=>r.cancel()),[n,r]),{searchValue:n,onSearchValueChange:a,query:s||void 0}},I=({queryKey:n,queryFn:a,getOptions:s,defaultValue:t,defaultValueKey:r,pageSize:i=10,enabled:u=!0})=>{const{searchValue:f,onSearchValueChange:b,query:h}=S(),D=r||"id",{data:m}=q({queryKey:n,queryFn:async()=>a({[D]:t,limit:Array.isArray(t)?t.length:1}),enabled:!!t&&u}),{data:d,...y}=v({queryKey:[...n,h],queryFn:async({pageParam:e=0})=>await a({q:h,limit:i,offset:e}),initialPageParam:0,getNextPageParam:e=>e.count>e.offset+e.limit?e.offset+e.limit:void 0,placeholderData:E,enabled:u}),o=(d==null?void 0:d.pages.flatMap(e=>s(e)))??[],l=m?s(m):[],x=!y.isPending&&!o.length&&!f||!u;return t&&l.length&&!f&&l.forEach(e=>{o.find(p=>p.value===e.value)||o.unshift(e)}),{options:o,searchValue:f,onSearchValueChange:b,disabled:x,...y}};export{S as a,I as u};
